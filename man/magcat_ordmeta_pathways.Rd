% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ordmeta_wrappers.R
\name{magcat_ordmeta_pathways}
\alias{magcat_ordmeta_pathways}
\title{Pathway-level ordmeta test on MAGMA gene p-values}
\usage{
magcat_ordmeta_pathways(
  gene_results,
  pathways = NULL,
  species = NULL,
  pmn_gene_col = NULL,
  gene_col = "GENE",
  p_col = "P",
  effect_col = "ZSTAT",
  is_onetail = FALSE,
  min_p = 1e-15,
  do_fix = TRUE,
  B = 10000L,
  output = FALSE,
  out_dir = "magcat_ordmeta"
)
}
\arguments{
\item{gene_results}{data.frame with at least gene + p-value columns.
Typically a MAGMA \code{.genes.out} file, with "GENE" and "P" (and "ZSTAT").}

\item{pathways}{either:
\itemize{
\item a named list: each element is a character vector of gene IDs
in that pathway, OR
\item a data.frame with columns \code{pathway_id}, \code{gene_id}
(and optional \code{pathway_name}).
}}

\item{species}{optional; one of "maize", "sorghum", "arabidopsis", "plant".
If provided, built-in PMN pathways are loaded via \code{magcat_load_pathways()}.
You must provide either \code{pathways} OR \code{species}, but not both.}

\item{pmn_gene_col}{optional; passed to \code{magcat_load_pathways(gene_col=...)}
when \code{species} is used. If NULL, PMN loader prefers "Gene-name"
and falls back to "Gene-id".}

\item{gene_col}{column name in \code{gene_results} containing gene IDs
(default "GENE").}

\item{p_col}{column name in \code{gene_results} containing gene-level p-values
(default "P").}

\item{effect_col}{column with effect size / Z-statistic to derive direction
(default "ZSTAT"). Only used when \code{is_onetail = FALSE}.}

\item{is_onetail}{logical; passed to \code{ordmeta(is.onetail=...)}.
Default FALSE (two-sided p-values + directions).}

\item{min_p}{lower cap for very small p-values (default 1e-15).}

\item{do_fix}{logical; if TRUE, clean p-values with \code{fix_p_for_acat()}
(0 -> min_p, 1 -> 1 - 1/d).}

\item{B}{Integer; number of Monte Carlo simulations used inside \code{ordmeta}
(default 10000).}

\item{output}{logical; if TRUE, write a CSV of results to \code{out_dir}.}

\item{out_dir}{directory to write CSV when \code{output = TRUE}
(default "magcat_ordmeta").}
}
\value{
data.frame with columns:
\itemize{
\item pathway_id
\item pathway_name
\item n_genes
\item gene_names
\item ordmeta_p
\item optimal_rank
\item eff_p_idx  (semicolon-separated indices)
\item MMP
\item overall_eff_direction
Sorted by \code{ordmeta_p} ascending (most significant first).
If \code{output = TRUE}, an attribute \code{"file"} is attached with the CSV path.
}
}
\description{
Pathway-level ordmeta test on MAGMA gene p-values
}
