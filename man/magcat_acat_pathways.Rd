% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ACAT_wrappers.R
\name{magcat_acat_pathways}
\alias{magcat_acat_pathways}
\title{ACAT pathway test on MAGMA gene p-values}
\usage{
magcat_acat_pathways(
  gene_results,
  pathways = NULL,
  species = NULL,
  pmn_gene_col = NULL,
  gene_col = "GENE",
  p_col = "P",
  min_p = 1e-15,
  do_fix = TRUE,
  B = 0L,
  seed = NULL,
  output = FALSE,
  out_dir = "magcat_acat"
)
}
\arguments{
\item{gene_results}{data.frame with at least a gene column and a p-value column.
Typically a MAGMA \code{.genes.out} file, where p-values are in column "P".}

\item{pathways}{either
\itemize{
\item a named list: each element is a character vector of gene IDs
in that pathway, OR
\item a data.frame with columns \code{pathway_id}, \code{gene_id}
(and optional \code{pathway_name}).
}}

\item{species}{optional; one of "maize", "sorghum", "arabidopsis", "plant".
If provided, built-in PMN pathways are loaded via \code{magcat_load_pathways()}.
You must provide either \code{pathways} OR \code{species}, but not both.}

\item{pmn_gene_col}{optional; passed to \code{magcat_load_pathways(gene_col=...)}
when \code{species} is used. If NULL, PMN loader will prefer "Gene-name"
and fall back to "Gene-id".}

\item{gene_col}{column name in \code{gene_results} containing gene IDs
(default "GENE").}

\item{p_col}{column name in \code{gene_results} containing gene-level p-values
(default "P").}

\item{min_p}{lower cap for very small p-values before ACAT (default 1e-15).}

\item{do_fix}{logical; if TRUE (default), clean p-values with
\code{fix_p_for_acat()}.}

\item{B}{integer; number of permutations for empirical p-values.
Default 0 (no permutations).}

\item{seed}{optional integer random seed for permutations (ignored if B == 0).}

\item{output}{logical; if TRUE, write a CSV of results to \code{out_dir}.}

\item{out_dir}{directory to write CSV when \code{output = TRUE}
(default "magcat_acat").}
}
\value{
data.frame with columns:
\describe{
\item{pathway_id}{pathway identifier}
\item{pathway_name}{pathway name (if available, otherwise same as id)}
\item{n_genes}{number of genes used in ACAT for this pathway}
\item{gene_names}{semicolon-separated gene IDs used in this pathway}
\item{acat_p}{ACAT p-value}
\item{perm_p}{permutation p-value (NA if B == 0)}
}
Sorted by \code{acat_p} in decreasing order (largest p first; NA at bottom).
If \code{output = TRUE}, an attribute \code{"file"} is attached with the CSV path.
}
\description{
ACAT pathway test on MAGMA gene p-values
}
