% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/minP_wrappers.R
\name{magcat_minp_pathways}
\alias{magcat_minp_pathways}
\title{Pathway-level minP on MAGMA gene p-values}
\usage{
magcat_minp_pathways(
  gene_results,
  pathways = NULL,
  species = NULL,
  pmn_gene_col = NULL,
  gene_col = "GENE",
  p_col = "P",
  min_p = 1e-15,
  do_fix = TRUE,
  B_perm = 0L,
  seed = NULL,
  analytic_logical = TRUE,
  output = FALSE,
  out_dir = "magcat_minp"
)
}
\arguments{
\item{gene_results}{data.frame with at least gene + p-value columns.
Typically a MAGMA \code{.genes.out} file, with "GENE" and "P".}

\item{pathways}{either:
\itemize{
\item a named list: each element is a character vector of gene IDs
in that pathway, OR
\item a data.frame with columns \code{pathway_id}, \code{gene_id}
(and optional \code{pathway_name}).
}}

\item{species}{optional; one of "maize", "sorghum", "arabidopsis", "plant".
If provided, built-in PMN pathways are loaded via \code{magcat_load_pathways()}.
You must provide either \code{pathways} OR \code{species}, but not both.}

\item{pmn_gene_col}{optional; passed to \code{magcat_load_pathways(gene_col=...)}
when \code{species} is used.}

\item{gene_col}{column name in \code{gene_results} containing gene IDs
(default "GENE").}

\item{p_col}{column name in \code{gene_results} containing gene-level p-values
(default "P").}

\item{min_p}{lower cap for very small p-values (default 1e-15).}

\item{do_fix}{logical; if TRUE, clean p-values with \code{fix_p_for_acat()}
(to keep them strictly in (0,1)).}

\item{B_perm}{integer; number of permutations for empirical p
(default 1000L = no permutations).}

\item{seed}{optional RNG seed for permutations (default NULL).}

\item{analytic_logical}{logical; if TRUE, compute analytic p via
\code{metap::minimump()}. If \code{metap} is not available, falls back to
Sidák: 1 - (1 - min_p)^K. (default TRUE)}

\item{output}{logical; if TRUE, write a CSV of results to \code{out_dir}.}

\item{out_dir}{directory to write CSV when \code{output = TRUE}
(default "magcat_minp").}
}
\value{
data.frame with columns:
\itemize{
\item pathway_id
\item pathway_name
\item n_genes
\item gene_names
\item gene_pvals        (semicolon-separated gene-level p's used in the test)
\item minp_stat         (min(p_i) for that pathway)
\item minp_p_perm       (permutation p; NA if B_perm = 0)
\item minp_p_analytic   (analytic p from minimump / Sidák; NA if
analytic_logical = FALSE)
Sorted by \code{minp_p_perm} ascending if B_perm > 0,
otherwise by \code{minp_p_analytic} (ascending) if available,
else by \code{minp_stat} (ascending).
If \code{output = TRUE}, an attribute \code{"file"} is attached with the CSV path.
}
}
\description{
For each pathway:
\itemize{
\item take gene-level p-values (e.g. MAGMA .genes.out),
\item compute the minimum p-value statistic: min(p_i),
\item optionally get analytic combined p via metap::minimump()
(Wilkinson / Tippett type minP),
\item optionally calibrate with gene-set permutations for empirical p.
}
}
\details{
All non-NA p-values in the pathway are used (no truncation / filtering),
except for cleaning to keep them strictly in (0,1) via fix_p_for_acat().
}
